# Test stack: postgres + redis + kafka for integration/e2e
services:
  postgres-test:
    image: postgres:16-alpine
    environment:
      POSTGRES_USER: auth_test
      POSTGRES_PASSWORD: auth_test
      POSTGRES_DB: auth_test
    ports:
      - "5433:5432"
    tmpfs:
      - /var/lib/postgresql/data

  redis-test:
    image: redis:7-alpine
    ports:
      - "6380:6379"

  kafka-test:
    image: bitnami/kafka:latest
    environment:
      KAFKA_CFG_NODE_ID: 0
      KAFKA_CFG_PROCESS_ROLES: controller,broker
      KAFKA_CFG_LISTENERS: PLAINTEXT://:9092,CONTROLLER://:9093
      KAFKA_CFG_ADVERTISED_LISTENERS: PLAINTEXT://kafka-test:9092
    ports:
      - "9093:9092"
